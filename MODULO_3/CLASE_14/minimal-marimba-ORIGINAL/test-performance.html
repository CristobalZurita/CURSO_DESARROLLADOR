<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Performance Test - Minimal Marimba</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: monospace; 
            background: #0a0a0a; 
            color: #00ff00; 
            padding: 20px;
            line-height: 1.8;
        }
        .container { max-width: 900px; margin: 0 auto; }
        h1 { color: #cc5500; margin-bottom: 20px; }
        .metric { 
            margin-bottom: 20px; 
            padding: 15px; 
            border: 1px solid #cc5500;
            border-radius: 4px;
        }
        .metric-label { color: #cccccc; font-weight: bold; }
        .metric-value { 
            color: #00ff00; 
            font-size: 20px; 
            margin-top: 5px;
            font-weight: bold;
        }
        .good { color: #00ff00; }
        .warning { color: #ffff00; }
        .bad { color: #ff0000; }
        .section { margin: 30px 0; }
        button { 
            background: #cc5500; 
            color: white; 
            border: none; 
            padding: 10px 20px; 
            cursor: pointer;
            border-radius: 4px;
            font-size: 16px;
        }
        button:hover { background: #ff6600; }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚ö° Performance Audit - Minimal Marimba</h1>
        
        <div class="section">
            <h2>üìä CORE WEB VITALS</h2>
            
            <div class="metric">
                <div class="metric-label">üìç First Contentful Paint (FCP)</div>
                <div class="metric-value" id="fcp">-</div>
                <small>Cu√°ndo comienza a renderizar contenido visible (deber√≠a ser &lt;1.8s)</small>
            </div>
            
            <div class="metric">
                <div class="metric-label">üé® Largest Contentful Paint (LCP)</div>
                <div class="metric-value" id="lcp">-</div>
                <small>Cu√°ndo carga el elemento m√°s grande (deber√≠a ser &lt;2.5s)</small>
            </div>
            
            <div class="metric">
                <div class="metric-label">‚ö° First Input Delay (FID)</div>
                <div class="metric-value" id="fid">-</div>
                <small>Retraso entre input y respuesta (deber√≠a ser &lt;100ms)</small>
            </div>
            
            <div class="metric">
                <div class="metric-label">‚ú® Cumulative Layout Shift (CLS)</div>
                <div class="metric-value" id="cls">-</div>
                <small>Movimiento inesperado de layout (deber√≠a ser &lt;0.1)</small>
            </div>
        </div>
        
        <div class="section">
            <h2>üì¶ RECURSOS CARGADOS</h2>
            
            <div class="metric">
                <div class="metric-label">üìÑ HTML Size</div>
                <div class="metric-value" id="html-size">-</div>
            </div>
            
            <div class="metric">
                <div class="metric-label">üé® CSS Size</div>
                <div class="metric-value" id="css-size">-</div>
            </div>
            
            <div class="metric">
                <div class="metric-label">‚öôÔ∏è JavaScript Size</div>
                <div class="metric-value" id="js-size">-</div>
            </div>
            
            <div class="metric">
                <div class="metric-label">üñºÔ∏è Total Images Size</div>
                <div class="metric-value" id="img-size">-</div>
            </div>
            
            <div class="metric">
                <div class="metric-label">üìä Total Page Size</div>
                <div class="metric-value" id="total-size">-</div>
            </div>
        </div>
        
        <div class="section">
            <h2>üîç VERIFICACIONES DE RENDIMIENTO</h2>
            
            <div id="checks" style="display: grid; gap: 10px;"></div>
        </div>
        
        <div class="section">
            <button onclick="runPerformanceTest()">üöÄ Ejecutar Test Completo</button>
        </div>
        
        <pre id="output" style="background: #1a1a1a; padding: 15px; border: 1px solid #333; margin-top: 20px; overflow-x: auto;"></pre>
    </div>

    <script>
    function runPerformanceTest() {
        console.clear();
        console.log('‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó');
        console.log('‚ïë  üöÄ PERFORMANCE TEST - Minimal Marimba            ‚ïë');
        console.log('‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n');
        
        // Core Web Vitals
        const perfData = performance.timing;
        const FCP = perfData.responseEnd - perfData.navigationStart;
        
        // Usa Navigation Timing API v2 si est√° disponible
        if (window.PerformanceObserver) {
            try {
                // LCP
                new PerformanceObserver((list) => {
                    const entries = list.getEntries();
                    const lcp = entries[entries.length - 1];
                    document.getElementById('lcp').innerHTML = `<span class="good">${(lcp.renderTime || lcp.loadTime).toFixed(2)}ms</span>`;
                }).observe({ entryTypes: ['largest-contentful-paint'] });
                
                // FID
                new PerformanceObserver((list) => {
                    list.getEntries().forEach((entry) => {
                        document.getElementById('fid').innerHTML = `<span class="good">${entry.processingDuration.toFixed(2)}ms</span>`;
                    });
                }).observe({ entryTypes: ['first-input'] });
                
                // CLS
                let clsValue = 0;
                new PerformanceObserver((list) => {
                    list.getEntries().forEach((entry) => {
                        if (!entry.hadRecentInput) {
                            clsValue += entry.value;
                        }
                    });
                    document.getElementById('cls').innerHTML = `<span class="${clsValue < 0.1 ? 'good' : clsValue < 0.25 ? 'warning' : 'bad'}">${clsValue.toFixed(3)}</span>`;
                }).observe({ entryTypes: ['layout-shift'] });
            } catch(e) {
                console.warn('PerformanceObserver no disponible:', e);
            }
        }
        
        document.getElementById('fcp').innerHTML = `<span class="good">${FCP}ms</span>`;
        
        // Resource Sizes (Network Tab API)
        if (performance.getEntriesByType) {
            let totalSize = 0;
            let cssSize = 0;
            let jsSize = 0;
            let imgSize = 0;
            
            performance.getEntriesByType('resource').forEach(resource => {
                const size = resource.transferSize || resource.decodedBodySize || 0;
                totalSize += size;
                
                if (resource.name.includes('.css')) cssSize += size;
                if (resource.name.includes('.js')) jsSize += size;
                if (/\.(jpg|jpeg|png|gif|webp|svg)/.test(resource.name)) imgSize += size;
            });
            
            document.getElementById('css-size').innerHTML = `<span class="${cssSize > 30000 ? 'warning' : 'good'}">${(cssSize / 1024).toFixed(2)} KB</span>`;
            document.getElementById('js-size').innerHTML = `<span class="${jsSize > 100000 ? 'bad' : jsSize > 50000 ? 'warning' : 'good'}">${(jsSize / 1024).toFixed(2)} KB</span>`;
            document.getElementById('img-size').innerHTML = `<span class="${imgSize > 500000 ? 'bad' : imgSize > 300000 ? 'warning' : 'good'}">${(imgSize / 1024).toFixed(2)} KB</span>`;
            document.getElementById('total-size').innerHTML = `<span class="${totalSize > 1000000 ? 'bad' : totalSize > 500000 ? 'warning' : 'good'}">${(totalSize / 1024).toFixed(2)} KB</span>`;
        }
        
        // Checks
        const checks = [
            {
                name: '‚úÖ Scripts con defer',
                check: () => document.querySelectorAll('script[defer]').length >= 3,
            },
            {
                name: '‚úÖ CSS con preload',
                check: () => document.querySelector('link[rel="preload"][as="style"]') !== null,
            },
            {
                name: '‚úÖ DNS Prefetch configurado',
                check: () => document.querySelectorAll('link[rel="dns-prefetch"]').length > 0,
            },
            {
                name: '‚úÖ Imagen con width/height',
                check: () => document.querySelector('img[width][height]') !== null,
            },
            {
                name: '‚úÖ Imagen con loading="lazy"',
                check: () => document.querySelector('img[loading="lazy"]') !== null,
            },
            {
                name: '‚úÖ Meta viewport present',
                check: () => document.querySelector('meta[name="viewport"]') !== null,
            },
            {
                name: '‚úÖ Charset declarado',
                check: () => document.querySelector('meta[charset]') !== null,
            },
            {
                name: '‚ùå jQuery sin bloqueante',
                check: () => !document.querySelector('script:not([defer]):not([async])'),
            },
        ];
        
        const checksDiv = document.getElementById('checks');
        checks.forEach(check => {
            const passed = check.check();
            const div = document.createElement('div');
            div.className = 'metric';
            div.innerHTML = `<div class="metric-value ${passed ? 'good' : 'bad'}">${check.name}</div>`;
            checksDiv.appendChild(div);
        });
        
        console.log('‚úÖ Test completado. Ver resultados arriba.\n');
    }
    
    // Auto-run on load
    window.addEventListener('load', () => {
        setTimeout(runPerformanceTest, 1000);
    });
    </script>
</body>
</html>
